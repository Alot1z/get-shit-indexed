# Plan 47-01: GSI Master Architecture Rectification & Native Evolution

## Objective
Rectify and consolidate the GSI architecture by removing legacy/unused code, standardizing module interfaces, and enabling native evolution through self-improving capabilities.

## Context
Current state: Architecture has accumulated technical debt
- Multiple integration modules with overlapping functionality
- Some modules created but never used (lib/gsi-integration/)
- Inconsistent module interfaces across lib/
- No unified module discovery/registration system
- Agent tool configurations could be more declarative

## Rectification Architecture

```
                    ┌─────────────────────────┐
                    │    GSI Module Registry  │
                    │   (lib/registry/)       │
                    └───────────┬─────────────┘
                                │
        ┌───────────────────────┼───────────────────────┐
        │                       │                       │
        ▼                       ▼                       ▼
┌───────────────┐       ┌───────────────┐       ┌───────────────┐
│    Active     │       │    Legacy     │       │    Native     │
│    Modules    │──────►│    Archive    │──────►│   Evolution   │
│  (Consolidate)│       │  (Deprecate)  │       │   (Generate)  │
└───────────────┘       └───────────────┘       └───────────────┘
```

## Tasks

### Task 1: Module Inventory & Classification
- [ ] Audit all modules in lib/ directory
- [ ] Classify as: ACTIVE, DEPRECATED, UNUSED
- [ ] Document module dependencies
- [ ] Identify duplicate functionality
- [ ] Create module-registry.json with classifications

### Task 2: Consolidate Integration Modules
- [ ] Merge lib/gsi-integration/ into lib/integration/
- [ ] Remove duplicate version-checker implementations
- [ ] Consolidate change-analyzer and suggester patterns
- [ ] Update all import references
- [ ] Test consolidated module

### Task 3: Standardize Module Interfaces
- [ ] Define standard module interface schema
- [ ] Add index.js exports to all modules missing them
- [ ] Create consistent initialization patterns
- [ ] Add module health check functions
- [ ] Document interface conventions

### Task 4: Create Module Registry System
- [ ] Create lib/registry/index.js
- [ ] Implement module discovery (auto-detect lib/*/index.js)
- [ ] Create module registration API
- [ ] Add dependency resolution
- [ ] Create module status dashboard

### Task 5: Archive Legacy Modules
- [ ] Move unused modules to lib/_archived/
- [ ] Update imports to use archived path or remove
- [ ] Add deprecation notices to archived modules
- [ ] Document migration paths
- [ ] Create archive manifest

### Task 6: Agent Tool Declarative Configuration
- [ ] Define agent tool schema in YAML/JSON
- [ ] Create tool-registry.js for tool discovery
- [ ] Update agents to use declarative tool config
- [ ] Add tool validation at load time
- [ ] Document tool configuration format

### Task 7: Native Evolution Foundation
- [ ] Create lib/evolution/index.js
- [ ] Implement module hot-reload capability
- [ ] Add module version tracking
- [ ] Create evolution rules engine
- [ ] Track evolution history

### Task 8: Self-Documentation System
- [ ] Create auto-doc generator for modules
- [ ] Generate module README from JSDoc
- [ ] Create API documentation index
- [ ] Add usage examples extraction
- [ ] Integrate with gsi docs command

### Task 9: Architecture Health Metrics
- [ ] Create lib/metrics/architecture.js
- [ ] Track module usage frequency
- [ ] Measure inter-module coupling
- [ ] Calculate code duplication percentage
- [ ] Generate architecture health report

### Task 10: Create gsi architecture CLI Command
- [ ] Create gsi architecture status command
- [ ] Show module registry status
- [ ] Show health metrics
- [ ] Show evolution history
- [ ] Add architecture optimization suggestions

## Success Criteria
- [ ] All modules classified and documented
- [ ] Duplicate functionality consolidated
- [ ] Module registry system functional
- [ ] Legacy modules properly archived
- [ ] Architecture health metrics available

## Estimated Time
120 minutes

## Dependencies
- Phase 44 (Knowledge Flow Integration)
- Phase 46 (Self-Improving Validation)

## Output
Rectified GSI architecture with standardized modules, unified registry, and native evolution foundation.
