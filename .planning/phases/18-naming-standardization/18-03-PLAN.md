---
phase: 18-naming-standardization
plan: 03
name: Consolidate Command Directories
type: execute
wave: 3
depends_on: ["18-01", "18-02"]
files_modified:
  - ~/.claude/commands/gsi/ (consolidated)
  - ~/.claude/commands/gsd/ (deleted after merge)
  - ~/.claude/commands/GSI/ (deleted after rename)
autonomous: true
estimated_tasks: 5
must_haves:
  truths:
    - "Single commands/gsi/ directory exists"
    - "No commands/gsd/ or commands/GSI/ directories remain"
    - "All command files accessible from gsi/ path"
    - "No duplicate command files"
  artifacts:
    - path: "~/.claude/commands/gsi/"
      provides: "Consolidated command directory"
      structure: "all command .md files"
  key_links:
    - from: "~/.claude/commands/gsd/"
      to: "~/.claude/commands/gsi/"
      via: "git mv merge"
    - from: "~/.claude/commands/GSI/"
      to: "~/.claude/commands/gsi/"
      via: "git mv rename"
---

<objective>
Merge commands/gsd/ and commands/GSI/ directories into a single commands/gsi/ directory, eliminating duplicate structures and legacy naming.

Purpose: Complete the naming standardization by consolidating all command files into a single lowercase gsi/ directory. This is the final cleanup step.

Output: Single ~/.claude/commands/gsi/ directory with all command files.
</objective>

<execution_context>
@~/.claude/get-shit-indexed/workflows/execute-plan.md
@~/.claude/get-shit-indexed/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-naming-standardization/18-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit existing command directories</name>
  <files>~/.claude/commands/</files>
  <action>
List all command directories and their contents to understand the merge scope:

```bash
# List all directories in commands/
ls -la ~/.claude/commands/

# List contents of each directory
echo "=== gsd/ contents ===" && ls ~/.claude/commands/gsd/ 2>/dev/null
echo "=== GSI/ contents ===" && ls ~/.claude/commands/GSI/ 2>/dev/null
echo "=== gsi/ contents (if exists) ===" && ls ~/.claude/commands/gsi/ 2>/dev/null

# Count files in each
find ~/.claude/commands/gsd -name "*.md" 2>/dev/null | wc -l
find ~/.claude/commands/GSI -name "*.md" 2>/dev/null | wc -l
```

Use mcp__desktop-commander__start_process. Record all files for merge planning.
  </action>
  <verify>Complete inventory of all command files in all directories</verify>
  <done>All command directories audited and files cataloged</done>
</task>

<task type="auto">
  <name>Task 2: Create gsi/ target directory and identify duplicates</name>
  <files>~/.claude/commands/gsi/</files>
  <action>
Create the target gsi/ directory and check for duplicate filenames:

```bash
# Create target directory if it doesn't exist
mkdir -p ~/.claude/commands/gsi/

# Find duplicate filenames between gsd/ and GSI/
comm -12 \
  <(ls ~/.claude/commands/gsd/ 2>/dev/null | sort) \
  <(ls ~/.claude/commands/GSI/ 2>/dev/null | sort)

# If gsi/ already exists, include it in comparison
if [ -d ~/.claude/commands/gsi/ ]; then
  echo "Files already in gsi/:" && ls ~/.claude/commands/gsi/
fi
```

Report any duplicates found. Duplicates need manual review to determine which version to keep.
  </action>
  <verify>gsi/ directory created, duplicate files identified</verify>
  <done>Target directory ready, duplicate resolution plan established</done>
</task>

<task type="auto">
  <name>Task 3: Merge gsd/ contents into gsi/</name>
  <files>~/.claude/commands/gsd/ → ~/.claude/commands/gsi/</files>
  <action>
Move all files from gsd/ to gsi/, handling conflicts:

```bash
cd ~/.claude/commands

# Move each file from gsd/ to gsi/
for file in gsd/*.md; do
  filename=$(basename "$file")
  if [ -f "gsi/$filename" ]; then
    echo "CONFLICT: $filename exists in gsi/"
    # Keep the newer/different one - move with .gsd suffix for review
    git mv "$file" "gsi/${filename%.md}.gsd.md"
  else
    git mv "$file" "gsi/$filename"
  fi
done

# Verify gsd/ is empty
ls gsd/ 2>/dev/null
```

Use git mv to preserve history. Flag conflicts for review.
  </action>
  <verify>gsd/ directory is empty or deleted, all files in gsi/</verify>
  <done>All gsd/ command files merged into gsi/ with conflicts flagged</done>
</task>

<task type="auto">
  <name>Task 4: Merge GSI/ contents into gsi/</name>
  <files>~/.claude/commands/GSI/ → ~/.claude/commands/gsi/</files>
  <action>
Move all files from GSI/ to gsi/, handling conflicts:

```bash
cd ~/.claude/commands

# Move each file from GSI/ to gsi/
for file in GSI/*.md; do
  filename=$(basename "$file")
  if [ -f "gsi/$filename" ]; then
    echo "CONFLICT: $filename exists in gsi/"
    # Keep with .GSI suffix for review
    git mv "$file" "gsi/${filename%.md}.GSI.md"
  else
    git mv "$file" "gsi/$filename"
  fi
done

# Verify GSI/ is empty
ls GSI/ 2>/dev/null
```

Use git mv to preserve history. Flag conflicts for review.
  </action>
  <verify>GSI/ directory is empty or deleted, all files in gsi/</verify>
  <done>All GSI/ command files merged into gsi/ with conflicts flagged</done>
</task>

<task type="auto">
  <name>Task 5: Remove empty legacy directories and stage changes</name>
  <files>~/.claude/commands/</files>
  <action>
Remove the now-empty legacy directories and stage all changes:

```bash
cd ~/.claude/commands

# Remove empty directories
rmdir gsd/ 2>/dev/null || echo "gsd/ not empty or doesn't exist"
rmdir GSI/ 2>/dev/null || echo "GSI/ not empty or doesn't exist"

# Verify final structure
ls -la ~/.claude/commands/

# Count files in gsi/
find gsi/ -name "*.md" | wc -l

# Stage all changes
cd ~/.claude && git add commands/

# Show status
git status commands/
```

Do NOT commit yet - final commit will be done after all Phase 18 plans complete.
  </action>
  <verify>Only gsi/ directory remains in commands/, all files staged</verify>
  <done>Command directory consolidation complete - single gsi/ directory with all commands</done>
</task>

</tasks>

<verification>
Verify Task 5 completion by running:
1. ls ~/.claude/commands/ - should only show gsi/
2. ls ~/.claude/commands/gsd/ 2>/dev/null - should fail (directory gone)
3. ls ~/.claude/commands/GSI/ 2>/dev/null - should fail (directory gone)
4. find ~/.claude/commands/gsi/ -name "*.md" | wc -l - should show all command files
</verification>

<success_criteria>
- [ ] commands/gsi/ directory exists with all command files
- [ ] commands/gsd/ directory removed (empty)
- [ ] commands/GSI/ directory removed (empty)
- [ ] No duplicate command files lost (conflicts flagged)
- [ ] Git history preserved for all moved files
- [ ] All changes staged for commit
</success_criteria>

<output>
After completion, create `.planning/phases/18-naming-standardization/18-03-SUMMARY.md` documenting:
- Files moved from gsd/ to gsi/
- Files moved from GSI/ to gsi/
- Any conflicts found and resolution
- Final command directory structure
- File counts before and after
</output>
