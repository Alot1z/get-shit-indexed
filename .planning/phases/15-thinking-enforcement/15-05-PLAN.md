---
phase: 15
plan: 05
name: Add PostToolUse Reflection Hook
description: Hook that triggers reflection after tool execution
tasks: 6
estimated_time: 10 min
---

# Plan 15-05: Add PostToolUse Reflection Hook

## Goal

PostToolUse hook that triggers reflection thinking after significant work.

## Tasks

### Task 1: Design reflection triggers
- [ ] Define what triggers reflection
- [ ] Set threshold (N tools executed, phase complete)
- [ ] Configure reflection depth

### Task 2: Create reflection-enforcer.js
- [ ] Track tool execution count
- [ ] Detect completion patterns
- [ ] Trigger reflection suggestion

### Task 3: Add reflection prompt templates
- [ ] Create generic reflection prompt
- [ ] Create task-specific prompts
- [ ] Add to templates/

### Task 4: Configure in settings.json
- [ ] Add PostToolUse hook config
- [ ] Set as optional (suggest, not require)
- [ ] Add enable/disable toggle

### Task 5: Add to build-hooks.js
- [ ] Include reflection-enforcer.js
- [ ] Add to HOOKS_TO_COPY
- [ ] Verify dist output

### Task 6: Test reflection behavior
- [ ] Test after single tool (no trigger)
- [ ] Test after N tools (trigger)
- [ ] Test with YOLO mode (skip)

## Verification

- [ ] Hook created
- [ ] Triggers appropriately
- [ ] Reflection prompts helpful

## Success Criteria

- reflection-enforcer.js created
- Integrated into install
- Tested and working
