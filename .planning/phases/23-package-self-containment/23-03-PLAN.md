---
phase: 23
plan: 03
name: Update Install Script for Rules
wave: 2
autonomous: true
objective: Update install.js to copy rules directory during installation
gap_closure: false
task_count: 6
files_modified:
  created: []
  modified:
    - bin/install.js
depends_on:
  - 23-01
  - 23-02
---

# Plan 23-03: Update Install Script for Rules

## Objective

Modify the install script (`bin/install.js`) to copy the `references/rules/` directory during installation so users get the rules files when they install GSI.

## Current State

The install script copies:
- `agents/` → `~/.claude/agents/`
- `commands/gsi/` → `~/.claude/commands/gsi/`
- `get-shit-indexed/` → `~/.claude/get-shit-indexed/`
- `hooks/gsi-*.js` → `~/.claude/hooks/`

It does NOT copy `references/rules/`.

## Tasks

### Task 1: Analyze current install.js structure
- [ ] Find where directories are copied
- [ ] Identify the copyWithPathReplacement function
- [ ] Understand the pattern for adding new directories

### Task 2: Add rules directory copy logic
- [ ] Add `references/rules/` to copy targets
- [ ] Ensure path replacement works for rules files
- [ ] Target: `~/.claude/get-shit-indexed/references/rules/`

### Task 3: Add uninstall cleanup for rules
- [ ] Add rules directory to uninstall cleanup
- [ ] Ensure clean uninstall removes rules

### Task 4: Test install with rules
- [ ] Run install script (dry-run if possible)
- [ ] Verify rules directory is created
- [ ] Verify all 4 files are copied

### Task 5: Update install help text
- [ ] Add note about rules files in help output
- [ ] Document what gets installed

### Task 6: Update manifest
- [ ] Add rules files to gsi-file-manifest.json (if exists)
- [ ] Ensure tracking includes rules directory

## Code Location

In `bin/install.js`, look for:
```javascript
// After agents/ copy section
const agentsDir = path.join(targetDir, 'agents');
// Add rules copy here
const rulesDir = path.join(targetDir, 'get-shit-indexed', 'references', 'rules');
```

## Verification

- [ ] Running `npx get-shit-indexed-cc --global` installs rules
- [ ] Rules appear at `~/.claude/get-shit-indexed/references/rules/`
- [ ] All 4 files present after install
- [ ] Uninstall removes rules directory

## Commit Message

```
feat(23-03): add rules directory to install script

- Copy references/rules/ during installation
- Add rules cleanup to uninstall process
- Rules install to ~/.claude/get-shit-indexed/references/rules/

Users now get validation and code review rules automatically.
```
