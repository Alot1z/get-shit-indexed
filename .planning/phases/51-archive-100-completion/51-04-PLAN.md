# Phase 51-04: Create Missing Commands (TDD)

**Phase**: 51 - Archive 100% Completion
**Plan**: 51-04
**Type**: Execution
**Wave**: 4
**Depends on**: 51-02, 51-03
**Status**: Not Started
**Date**: 2026-02-20

---

## Objective

Create 8 missing GSI commands with TDD verification ensuring each command properly integrates with its backing lib module.

## Must-Haves

### Observable Truths
1. `/gsi:knowledge` queries knowledge hub
2. `/gsi:search-knowledge` performs semantic search
3. `/gsi:module-status` shows module health
4. `/gsi:sdk-config` manages SDK profiles
5. `/gsi:features` explores feature registry
6. `/gsi:build` handles distribution
7. `/gsi:agent` orchestrates agents

### Artifacts
- `commands/gsi/knowledge.md` - knowledge hub command
- `commands/gsi/search-knowledge.md` - semantic search command
- `commands/gsi/module-status.md` - health check command
- `commands/gsi/sdk-config.md` - SDK management command
- `commands/gsi/features.md` - feature registry command
- `commands/gsi/build.md` - distribution command
- `commands/gsi/agent.md` - agent command

### Key Links
- Commands → lib modules (via require/import)
- MCP tools (via allowed-tools)

---

## Tasks

### Task 1: Create /gsi:knowledge command

**Files**: `commands/gsi/knowledge.md`

**Action:**
```markdown
# /gsi:knowledge

<objective>
Query knowledge hub capabilities and search knowledge base.
</objective>

<execution_context>
@lib/knowledge-hub
</execution_context>

<process>
1. Load knowledge hub module
2. List producers/consumers
3. Query knowledge by type
</process>
```

**TDD Test:**
```bash
# Verify command file exists with required sections
grep -E "^<(objective|process)" commands/gsi/knowledge.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command executes without error
**Done:** ○ PENDING

---

### Task 2: Create /gsi:search-knowledge command

**Files**: `commands/gsi/search-knowledge.md`

**Action:**
```markdown
# /gsi:search-knowledge

<objective>
Semantic search across knowledge base using embeddings.
</objective>

<execution_context>
@lib/knowledge
</execution_context>

<process>
1. Parse search query
2. Call semantic search via lib/knowledge
3. Return ranked results
</process>
```

**TDD Test:**
```bash
grep -E "^<(objective|process)" commands/gsi/search-knowledge.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command executes without error
**Done:** ○ PENDING

---

### Task 3: Create /gsi:module-status command

**Files**: `commands/gsi/module-status.md`

**Action:**
```markdown
# /gsi:module-status

<objective>
Health check all lib modules and show status.
</objective>

<execution_context>
@lib/module-registry
</execution_context>

<process>
1. Load module registry
2. Check health of each module
3. Display status table
</process>
```

**TDD Test:**
```bash
grep -E "^<(objective|process)" commands/gsi/module-status.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command shows module health
**Done:** ○ PENDING

---

### Task 4: Create /gsi:sdk-config command

**Files**: `commands/gsi/sdk-config.md`

**Action:**
```markdown
# /gsi:sdk-config

<objective>
SDK profile and authentication management.
</objective>

<execution_context>
@lib/sdk
</execution_context>

<process>
1. Check current profile
2. Allow profile switching
3. Show auth status
</process>
```

**TDD Test:**
```bash
grep -E "^<(objective|process)" commands/gsi/sdk-config.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command manages SDK profiles
**Done:** ○ PENDING

---

### Task 5: Create /gsi:features command

**Files**: `commands/gsi/features.md`

**Action:**
```markdown
# /gsi:features

<objective>
Feature registry exploration and management.
</objective>

<execution_context>
@lib/enhancement
</execution_context>

<process>
1. List all features
2. Show feature status
3. Allow enable/disable
</process>
```

**TDD Test:**
```bash
grep -E "^<(objective|process)" commands/gsi/features.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command lists features
**Done:** ○ PENDING

---

### Task 6: Create /gsi:build command

**Files**: `commands/gsi/build.md`

**Action:**
```markdown
# /gsi:build

<objective>
Distribution layer operations for packaging.
</objective>

<execution_context>
@lib/distribution
</execution_context>

<process>
1. Build artifacts
2. Compress output
3. Package for distribution
</process>
```

**TDD Test:**
```bash
grep -E "^<(objective|process)" commands/gsi/build.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command builds distribution
**Done:** ○ PENDING

---

### Task 7: Create /gsi:agent command

**Files**: `commands/gsi/agent.md`

**Action:**
```markdown
# /gsi:agent

<objective>
Agent orchestration with task queues and profiles.
</objective>

<execution_context>
@lib/agent-framework
</execution_context>

<process>
1. Manage task queue
2. Load playbooks
3. Execute with profile
</process>
```

**TDD Test:**
```bash
grep -E "^<(objective|process)" commands/gsi/agent.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command orchestrates agents
**Done:** ○ PENDING

---

### Task 8: Update /gsi:files-to-prompt

**Files**: `commands/gsi/files-to-prompt.md`

**Action:**
- Update to use lib/core-engine instead of standalone implementation

**TDD Test:**
```bash
grep "core-engine" commands/gsi/files-to-prompt.md && echo "PASS" || echo "FAIL"
# Expected: PASS
```

**Verify:** Command uses core-engine module
**Done:** ○ PENDING

---

## Verification

### Command Existence Test
```bash
# Verify all 8 commands exist
for cmd in knowledge search-knowledge module-status sdk-config features build agent files-to-prompt; do
  if [ -f "commands/gsi/$cmd.md" ]; then
    echo "✓ $cmd.md exists"
  else
    echo "✗ $cmd.md MISSING"
  fi
done
```

### Command Structure Test
```bash
# Verify all commands have required sections
for cmd in knowledge search-knowledge module-status sdk-config features build agent; do
  if grep -qE "^<(objective|process)" "commands/gsi/$cmd.md" 2>/dev/null; then
    echo "✓ $cmd has required sections"
  else
    echo "✗ $cmd missing sections"
  fi
done
```

### Success Criteria
- [ ] /gsi:knowledge command created
- [ ] /gsi:search-knowledge command created
- [ ] /gsi:module-status command created
- [ ] /gsi:sdk-config command created
- [ ] /gsi:features command created
- [ ] /gsi:build command created
- [ ] /gsi:agent command created
- [ ] /gsi:files-to-prompt updated

---

## Output

After completion:
1. 8 new/updated commands available
2. All commands use backing lib modules
3. TDD tests pass for each command
4. MCP tools properly declared

---

**Progress**: 0/8 tasks complete (0%)
