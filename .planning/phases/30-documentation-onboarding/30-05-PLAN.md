---
phase: 30
plan: 05
title: Architecture Documentation
wave: 1
depends_on: [30-01]
files_modified:
  - docs/architecture/README.md
  - docs/architecture/components.md
  - docs/architecture/flows.md
autonomous: true
must_haves:
  truths:
    - Components documented
    - Data flows explained
    - Integration points clear
  artifacts:
    - docs/architecture/README.md:100
    - docs/architecture/components.md:250
    - docs/architecture/flows.md:200
---

# 30-05: Architecture Documentation

## Objective
Document GSI system architecture for contributors and advanced users.

## Tasks

### Task 1: Component Overview
**File**: `docs/architecture/components.md`
**Lines**: ~250

```markdown
# GSI Components

## Core Components

### GSI Core (`lib/gsi-core/`)
Central orchestration layer.

**Responsibilities**:
- Command routing
- Configuration management
- Hook orchestration
- Skill loading

**Key Modules**:
- `router.ts`: Command dispatcher
- `config.ts`: Configuration loader
- `hooks.ts`: Hook manager
- `skills.ts`: Skill registry

### MCP Bridge (`lib/mcp-bridge/`)
Interface to MCP servers.

**Responsibilities**:
- MCP server communication
- Tool invocation
- Response handling
- Error translation

**Key Modules**:
- `client.ts`: MCP client
- `tools.ts`: Tool registry
- `transport.ts`: Transport layer

### Skill Engine (`lib/skill-engine/`)
Skill execution environment.

**Responsibilities**:
- Skill parsing
- Context injection
- Agent spawning
- Result aggregation

**Key Modules**:
- `parser.ts`: YAML parser
- `executor.ts`: Skill runner
- `context.ts`: Context builder

## Support Components

### Desktop Commander MCP
File operations and process management.

### Code Index MCP
Code search and symbol extraction.

### Context7
External documentation retrieval.
```

### Task 2: Data Flows
**File**: `docs/architecture/flows.md`
**Lines**: ~200

```markdown
# Data Flows

## Command Execution Flow

\`\`\`
User Input → GSI CLI
    ↓
Command Router → Parse Arguments
    ↓
Hook Manager → Pre-Hooks
    ↓
MCP Bridge → Execute via MCP
    ↓
Response Processor → Format Output
    ↓
Hook Manager → Post-Hooks
    ↓
Output to User
\`\`\`

## Skill Execution Flow

\`\`\`
Skill Invocation → Parse skill.yaml
    ↓
Context Builder → Load context files
    ↓
Agent Spawner → Create specialized agent
    ↓
MCP Tools → Execute operations
    ↓
Result Aggregator → Combine results
    ↓
Return to Caller
\`\`\`

## Hook Pipeline Flow

\`\`\`
Trigger Event → Match Patterns
    ↓
Pre-Hooks (by priority) → Modify input
    ↓
Core Operation → Execute
    ↓
Post-Hooks (by priority) → Modify output
    ↓
Result → Return
\`\`\`
```

### Task 3: Architecture Index
**File**: `docs/architecture/README.md`
**Lines**: ~100

```markdown
# GSI Architecture

## Overview

GSI is a modular system built on:
- MCP (Model Context Protocol) for tool access
- Skills for pre-packaged workflows
- Hooks for customization

## Documentation

1. [Components](./components.md) - System components
2. [Data Flows](./flows.md) - How data moves
3. [Integration](./integration.md) - Extension points

## Design Principles

1. **MCP First**: Use MCP tools over native
2. **Skill-based**: Package workflows as skills
3. **Hookable**: Enable customization at all levels
4. **Token Efficient**: Optimize for context limits
```

## Output
- Component documentation
- Data flow diagrams
- Architecture overview

**Next**: 30-06 - CLI Reference
